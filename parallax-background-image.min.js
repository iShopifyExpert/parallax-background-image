(function(a){'use strict';function b(O,Q=document){return'string'==typeof O?Q.querySelector(O):O}function f(O,Q=document){return O instanceof Element?[O]:Array.isArray(O)?O:('string'==typeof O&&(O=Q.querySelectorAll(O)),Array.prototype.slice.call(O))}function g(O){return'function'==typeof O?O:()=>O}function h(O){const Q=g(O);return R=>new Promise(S=>S(Q(R)))}function j(O,Q){return h(Q)(O).then(k)}function k(O){return new Promise((Q,R)=>{const S=document.createElement('img');S.onload=T=>{Q(T.target)},S.onerror=T=>{R(T.error)},S.src=O})}function l(O){return O.match(/url\(['"]?(.*?)['"]?\)/)[1]}function n(){const O=o();return document.head.insertBefore(O,document.head.firstElementChild),O.sheet}function o(){const O=document.createElement('style');return O.appendChild(document.createTextNode('')),O}function p(O,Q=null){return(R,S,T)=>{Q=Q||R;const U=O(R,S,T);return new B(U,Q,T)}}function q(O){return Object.assign({},F,O)}function s(O,Q,R){const S=1/R,T=O.viewport;return{scale:S,translateX:O.left*(S-1),translateY:((T.height-Q.height)*S-(T.height-O.height))/2,translateZ:T.perspective*(1-S)}}function t(O,Q,R){const S=O.viewport,T=S.top+S.height/2,U=O.top+O.height/2,V=O.top+Q.height/2;return{scale:1,translateX:0,translateY:(U-T)*(R-1)-(V-U),translateZ:0}}function v(){return-1!==navigator.userAgent.indexOf('Chrome/')}const w='data-parallax-element',x=O=>{const Q=window.getComputedStyle(O);return l(Q.backgroundImage)};var y=function(O,Q,R,S){var V,T=arguments.length,U=3>T?Q:null===S?S=Object.getOwnPropertyDescriptor(Q,R):S;if('object'==typeof Reflect&&'function'==typeof Reflect.decorate)U=Reflect.decorate(O,Q,R,S);else for(var W=O.length-1;0<=W;W--)(V=O[W])&&(U=(3>T?V(U):3<T?V(Q,R,U):V(Q,R))||U);return 3<T&&U&&Object.defineProperty(Q,R,U),U};class z{constructor(O,Q,R){this.style=O,this.width=Q,this.height=R,Object.assign(O,{position:'absolute',left:'0',top:'0',transformOrigin:'0 0 0',pointerEvents:'none'})}updateTransform(O){this.style.transform=`
            translateX(${O.translateX}px)
            translateY(${O.translateY}px)
            translateZ(${O.translateZ}px)
            scale(${O.scale}, ${O.scale})`}}class A{constructor(O){this.background=O}updateTransform(O){this.background.updateTransform(Object.assign({},O,{scale:O.scale*this.scale}))}get height(){return this.background.height*this.scale}get width(){return this.background.width*this.scale}}y([a.computed],A.prototype,'height',null),y([a.computed],A.prototype,'width',null);class B extends A{constructor(O,Q,R){super(O),this.element=Q,this.velocityScale=R}get scale(){return Math.max(this.minimalHeight/this.background.height,this.minimalWidth/this.background.width)}get minimalHeight(){const{height:O}=this.element.viewport,{height:Q}=this.element,R=1<this.velocityScale?Q+(this.velocityScale-1)*(O+Q):Q+(1-this.velocityScale)*(O-Q),S=O+this.velocityScale*(O-Q);return Math.max(R,S)}get minimalWidth(){return this.element.width}}y([a.computed],B.prototype,'scale',null),y([a.computed],B.prototype,'minimalHeight',null),y([a.computed],B.prototype,'minimalWidth',null);const C=(O,Q)=>{const R=`[${w}="${O.id}"]::before {
        content: '';
        width: ${Q.naturalWidth}px;
        height: ${Q.naturalHeight}px;
        background-image: url(${Q.src});
        background-size: 100% 100%;
    }`,S=E.insertRule(R,0),T=E.cssRules[S].style;return new z(T,Q.naturalWidth,Q.naturalHeight)},E=function(){const O=o();return document.head.appendChild(O),O.sheet}(),F={velocityScale:0.8,backgroundImage:x,createBackground:p(C)};var G=function(O,Q,R,S){var V,T=arguments.length,U=3>T?Q:null===S?S=Object.getOwnPropertyDescriptor(Q,R):S;if('object'==typeof Reflect&&'function'==typeof Reflect.decorate)U=Reflect.decorate(O,Q,R,S);else for(var W=O.length-1;0<=W;W--)(V=O[W])&&(U=(3>T?V(U):3<T?V(Q,R,U):V(Q,R))||U);return 3<T&&U&&Object.defineProperty(Q,R,U),U};class H{constructor(O){const Q=()=>{this.update(O.getBoundingClientRect()),window.requestAnimationFrame(Q)};Q()}update(O){for(let Q of['bottom','height','left','right','top','width'])this[Q]=O[Q]}}G([a.observable],H.prototype,'bottom',void 0),G([a.observable],H.prototype,'height',void 0),G([a.observable],H.prototype,'left',void 0),G([a.observable],H.prototype,'right',void 0),G([a.observable],H.prototype,'top',void 0),G([a.observable],H.prototype,'width',void 0),G([a.action],H.prototype,'update',null);var I=function(O,Q,R,S){var V,T=arguments.length,U=3>T?Q:null===S?S=Object.getOwnPropertyDescriptor(Q,R):S;if('object'==typeof Reflect&&'function'==typeof Reflect.decorate)U=Reflect.decorate(O,Q,R,S);else for(var W=O.length-1;0<=W;W--)(V=O[W])&&(U=(3>T?V(U):3<T?V(Q,R,U):V(Q,R))||U);return 3<T&&U&&Object.defineProperty(Q,R,U),U};class J{constructor(O,Q){Object.assign(O.style,{overflowY:'scroll',transformStyle:'flat',perspective:Q+'px',perspectiveOrigin:'0 0'}),this.element=O,this.perspective=Q,this.boundingClientRect=new H(O)}get height(){return this.boundingClientRect.height}get top(){return this.boundingClientRect.top}}I([a.computed],J.prototype,'height',null),I([a.computed],J.prototype,'top',null);var K=function(O,Q,R,S){var V,T=arguments.length,U=3>T?Q:null===S?S=Object.getOwnPropertyDescriptor(Q,R):S;if('object'==typeof Reflect&&'function'==typeof Reflect.decorate)U=Reflect.decorate(O,Q,R,S);else for(var W=O.length-1;0<=W;W--)(V=O[W])&&(U=(3>T?V(U):3<T?V(Q,R,U):V(Q,R))||U);return 3<T&&U&&Object.defineProperty(Q,R,U),U};class L{constructor(O,Q){this.id=L.getNextId(),this.element=O,this.boundingClientRect=new H(O),this.viewport=Q,this.element.setAttribute(w,this.id)}get width(){return this.boundingClientRect.width}get height(){return this.boundingClientRect.height}get left(){return this.boundingClientRect.left}get top(){return this.boundingClientRect.top}static getNextId(){return`${L.nextId++}`}}L.nextId=0,K([a.computed],L.prototype,'width',null),K([a.computed],L.prototype,'height',null),K([a.computed],L.prototype,'left',null),K([a.computed],L.prototype,'top',null);var M=function(O,Q,R,S){return new(R||(R=Promise))(function(T,U){function V(Y){try{X(S.next(Y))}catch(Z){U(Z)}}function W(Y){try{X(S['throw'](Y))}catch(Z){U(Z)}}function X(Y){Y.done?T(Y.value):new R(function(Z){Z(Y.value)}).then(V,W)}X((S=S.apply(O,Q||[])).next())})};(function(){const O=n();O.insertRule(`
        [${w}] > * {
            position: relative;
        }
    `,0),O.insertRule(`
        [${w}] {
            position: relative;
            overflow: hidden;
        }
    `,0)})();class N{constructor(O,Q=!v(),R=1e3){Q&&(R=0),this.useFallback=Q,this.viewport=new J(b(O),R)}add(O,Q={}){const R=q(Q);if(0>R.velocityScale)throw new RangeError('velocityScale must be positive');return f(O,this.viewport.element).filter(S=>!S.hasAttribute(w)).map(S=>this.addElement(S,R))}addElement(O,Q){return M(this,void 0,void 0,function*(){const R=yield j(O,Q.backgroundImage),S=new L(O,this.viewport),T=Q.createBackground(S,R,Q.velocityScale),U=this.useFallback?t:s;a.autorun(()=>{T.updateTransform(U(S,T,Q.velocityScale))})})}}N.getCSSBackgroundImage=x,N.pesudoBefore=C,N.insertImg=(O,Q)=>{const R=document.createElement('img');return R.height=Q.naturalHeight,R.width=Q.naturalWidth,R.src=Q.src,O.element.insertBefore(R,O.element.firstElementChild),new z(R.style,Q.naturalWidth,Q.naturalHeight)},N.coverElement=p,window.Parallax=N})(mobx);
