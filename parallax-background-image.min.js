var Parallax=function(a,b){"use strict";function f(O,Q,R,S){var V,T=arguments.length,U=3>T?Q:null===S?S=Object.getOwnPropertyDescriptor(Q,R):S;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)U=Reflect.decorate(O,Q,R,S);else for(var W=O.length-1;0<=W;W--)(V=O[W])&&(U=(3>T?V(U):3<T?V(Q,R,U):V(Q,R))||U);return 3<T&&U&&Object.defineProperty(Q,R,U),U}function g(O,Q,R,S){return new(R||(R=Promise))(function(T,U){function V(Y){try{X(S.next(Y))}catch(Z){U(Z)}}function W(Y){try{X(S.throw(Y))}catch(Z){U(Z)}}function X(Y){Y.done?T(Y.value):new R(function(Z){Z(Y.value)}).then(V,W)}X((S=S.apply(O,Q||[])).next())})}function h(O,Q=document){return"string"==typeof O?Q.querySelector(O):O}function j(O,Q=document){return O instanceof Element?[O]:Array.isArray(O)?O:("string"==typeof O&&(O=Q.querySelectorAll(O)),Array.prototype.slice.call(O))}function k(O){return"function"==typeof O?O:()=>O}function l(O){const Q=k(O);return function(){return new Promise((R)=>R(Q.apply(this,arguments)))}}function m(O,Q){return l(Q)(O).then(n)}function n(O){return new Promise((Q,R)=>{const S=document.createElement("img");S.onload=(T)=>{Q(T.target)},S.onerror=(T)=>{R(T.error)},S.src=O})}function o(O){return O.match(/url\(['"]?(.*?)['"]?\)/)[1]}function q(){const O=s();return document.head.insertBefore(O,document.head.firstElementChild),O.sheet}function s(){const O=document.createElement("style");return O.appendChild(document.createTextNode("")),O}function t(O,Q=null){return(R,S)=>{const T=O(R,S);return new F(T,Q||R)}}function u(O){return Object.assign({},J,O)}function v(O,Q){const R=1/O.velocityScale,S=O.viewport;return{scale:R,translateX:O.left*(R-1),translateY:((S.height-Q.height)*R-(S.height-O.height))/2,translateZ:S.perspective*(1-R)}}function w(O,Q){const R=O.viewport,S=R.top+R.height/2,T=O.top+O.height/2,U=O.top+Q.height/2;return{scale:1,translateX:0,translateY:(T-S)*(O.velocityScale-1)-(U-T),translateZ:0}}function x(O,Q,R){return(S)=>Object.assign({},S,{translateX:S.translateX-(Q.width-O.width)*R})}function z(){const{userAgent:O}=navigator;return O.includes("Chrome/")&&!O.includes("Edge/")}function A(O){O.style.setProperty("background","none","important"),O.style.setProperty("background-image","none","important")}const B="data-parallax-element",C=(O)=>{const Q=window.getComputedStyle(O);return o(Q.backgroundImage)};class D{constructor(O,Q,R){this.style=O,this.width=Q,this.height=R,b.scheduler.write(()=>{Object.assign(O,{position:"absolute",left:"0",top:"0",transformOrigin:"0 0 0",pointerEvents:"none"})})}updateTransform(O){const Q=`
            translateX(${O.translateX}px)
            translateY(${O.translateY}px)
            translateZ(${O.translateZ}px)
            scale(${O.scale}, ${O.scale})`;b.scheduler.write(()=>{this.style.transform=Q})}}class E{constructor(O){this.background=O}updateTransform(O){this.background.updateTransform(Object.assign({},O,{scale:O.scale*this.scale}))}get height(){return this.background.height*this.scale}get width(){return this.background.width*this.scale}}f([a.computed],E.prototype,"height",null),f([a.computed],E.prototype,"width",null);class F extends E{constructor(O,Q){super(O),this.element=Q}get scale(){return Math.max(this.minimalHeight/this.background.height,this.minimalWidth/this.background.width)}get minimalHeight(){const{height:O}=this.element.viewport,{height:Q,velocityScale:R}=this.element;return O+R*(O-Q)}get minimalWidth(){return this.element.width}}f([a.computed],F.prototype,"scale",null),f([a.computed],F.prototype,"minimalHeight",null),f([a.computed],F.prototype,"minimalWidth",null);const H=(O,Q)=>{const R=document.createElement("img");return b.scheduler.write(()=>{R.height=Q.naturalHeight,R.width=Q.naturalWidth,R.src=Q.src,O.element.insertBefore(R,O.element.firstElementChild)}),new D(R.style,Q.naturalWidth,Q.naturalHeight)},I=function(){const O=s();return document.head.appendChild(O),O.sheet}(),J={velocityScale:0.8,horizontalAlign:0.5,backgroundImage:C,createBackground:t(H)};class K{constructor(O){this.bottom=0,this.height=0,this.left=0,this.right=0,this.top=0,this.width=0;const Q=()=>{this.update(O.getBoundingClientRect()),b.scheduler.read(Q)};b.scheduler.read(Q)}update(O){this.bottom=O.bottom,this.height=O.height,this.left=O.left,this.right=O.right,this.top=O.top,this.width=O.width}}f([a.observable],K.prototype,"bottom",void 0),f([a.observable],K.prototype,"height",void 0),f([a.observable],K.prototype,"left",void 0),f([a.observable],K.prototype,"right",void 0),f([a.observable],K.prototype,"top",void 0),f([a.observable],K.prototype,"width",void 0),f([a.action],K.prototype,"update",null);class L{constructor(O,Q){Object.assign(O.style,{overflowY:"scroll",webkitOverflowScrolling:"touch",transformStyle:"flat",perspective:Q+"px",perspectiveOrigin:"0 0"}),this.element=O,this.perspective=Q,this.boundingClientRect=new K(O)}get height(){return this.boundingClientRect.height}get top(){return this.boundingClientRect.top}}f([a.computed],L.prototype,"height",null),f([a.computed],L.prototype,"top",null);class M{constructor(O,Q,R){this.id=M.getNextId(),this.element=O,this.boundingClientRect=new K(O),this.viewport=Q,this.velocityScale=R,b.scheduler.write(()=>{this.element.setAttribute(B,this.id)})}get width(){return this.boundingClientRect.width}get height(){return this.boundingClientRect.height}get left(){return this.boundingClientRect.left}get top(){return this.boundingClientRect.top}static getNextId(){return`${M.nextId++}`}}M.nextId=0,f([a.computed],M.prototype,"width",null),f([a.computed],M.prototype,"height",null),f([a.computed],M.prototype,"left",null),f([a.computed],M.prototype,"top",null),function(){const O=q();O.insertRule(`
        [${B}] > * {
            position: relative;
        }
    `,0),O.insertRule(`
        [${B}] {
            position: relative;
            overflow: hidden;
        }
    `,0)}();class N{constructor(O,Q=!z(),R=1e3){Q&&(R=0),this.useFallback=Q,this.viewport=new L(h(O),R)}add(O,Q={}){const R=u(Q);if(0>R.velocityScale)throw new RangeError("velocityScale must be positive");return j(O,this.viewport.element).filter((S)=>!S.hasAttribute(B)).map((S)=>this.addElement(S,R))}addElement(O,Q){return g(this,void 0,void 0,function*(){const R=yield m(O,Q.backgroundImage),S=new M(O,this.viewport,Q.velocityScale);A(O);const T=Q.createBackground(S,R),U=this.useFallback?w:v,V=x(S,T,Q.horizontalAlign);a.autorun(()=>{const W=U(S,T);T.updateTransform(V(W))})})}}return N.getCSSBackgroundImage=C,N.pesudoBefore=(O,Q)=>{const R=`[${B}="${O.id}"]::before {
        content: '';
        width: ${Q.naturalWidth}px;
        height: ${Q.naturalHeight}px;
        background-image: url(${Q.src});
        background-size: 100% 100%;
    }`,S=I.insertRule(R,0),T=I.cssRules[S].style;return new D(T,Q.naturalWidth,Q.naturalHeight)},N.insertImg=H,N.coverElement=t,N}(mobx,domScheduler);
