(function(a){'use strict';function b(Q,R=document){return'string'==typeof Q?R.querySelector(Q):Q}function f(Q,R=document){return Q instanceof Element?[Q]:Array.isArray(Q)?Q:('string'==typeof Q&&(Q=R.querySelectorAll(Q)),Array.prototype.slice.call(Q))}function g(Q){return'function'==typeof Q?Q:()=>Q}function h(Q){const R=g(Q);return function(){return x(this,arguments,void 0,function*(){return yield R.apply(this,arguments)})}}function j(Q,R){return h(R)(Q).then(k)}function k(Q){return new Promise((R,S)=>{const T=document.createElement('img');T.onload=U=>{R(U.target)},T.onerror=U=>{S(U.error)},T.src=Q})}function l(Q){return Q.match(/url\(['"]?(.*?)['"]?\)/)[1]}function n(){const Q=o();return document.head.insertBefore(Q,document.head.firstElementChild),Q.sheet}function o(){const Q=document.createElement('style');return Q.appendChild(document.createTextNode('')),Q}function p(Q,R=null){return(S,T)=>{R=R||S;const U=Q(S,T);return new C(U,R)}}function q(Q){return Object.assign({},G,Q)}function s(Q,R){const S=1/Q.velocityScale,T=Q.viewport;return{scale:S,translateX:Q.left*(S-1),translateY:((T.height-R.height)*S-(T.height-Q.height))/2,translateZ:T.perspective*(1-S)}}function t(Q,R){const S=Q.viewport,T=S.top+S.height/2,U=Q.top+Q.height/2,V=Q.top+R.height/2;return{scale:1,translateX:0,translateY:(U-T)*(Q.velocityScale-1)-(V-U),translateZ:0}}function v(){return-1!==navigator.userAgent.indexOf('Chrome/')}const w='data-parallax-element';var x=function(Q,R,S,T){return new(S||(S=Promise))(function(U,V){function W(Z){try{Y(T.next(Z))}catch($){V($)}}function X(Z){try{Y(T['throw'](Z))}catch($){V($)}}function Y(Z){Z.done?U(Z.value):new S(function($){$(Z.value)}).then(W,X)}Y((T=T.apply(Q,R||[])).next())})};const y=Q=>{const R=window.getComputedStyle(Q);return l(R.backgroundImage)};var z=function(Q,R,S,T){var W,U=arguments.length,V=3>U?R:null===T?T=Object.getOwnPropertyDescriptor(R,S):T;if('object'==typeof Reflect&&'function'==typeof Reflect.decorate)V=Reflect.decorate(Q,R,S,T);else for(var X=Q.length-1;0<=X;X--)(W=Q[X])&&(V=(3>U?W(V):3<U?W(R,S,V):W(R,S))||V);return 3<U&&V&&Object.defineProperty(R,S,V),V};class A{constructor(Q,R,S){this.style=Q,this.width=R,this.height=S,Object.assign(Q,{position:'absolute',left:'0',top:'0',transformOrigin:'0 0 0',pointerEvents:'none'})}updateTransform(Q){window.requestAnimationFrame(()=>{this.style.transform=`
                translateX(${Q.translateX}px)
                translateY(${Q.translateY}px)
                translateZ(${Q.translateZ}px)
                scale(${Q.scale}, ${Q.scale})`})}}class B{constructor(Q){this.background=Q}updateTransform(Q){this.background.updateTransform(Object.assign({},Q,{scale:Q.scale*this.scale}))}get height(){return this.background.height*this.scale}get width(){return this.background.width*this.scale}}z([a.computed],B.prototype,'height',null),z([a.computed],B.prototype,'width',null);class C extends B{constructor(Q,R){super(Q),this.element=R}get scale(){return Math.max(this.minimalHeight/this.background.height,this.minimalWidth/this.background.width)}get minimalHeight(){const{height:Q}=this.element.viewport,{height:R,velocityScale:S}=this.element,T=1<S?R+(S-1)*(Q+R):R+(1-S)*(Q-R);return Math.max(T,Q+S*(Q-R))}get minimalWidth(){return this.element.width}}z([a.computed],C.prototype,'scale',null),z([a.computed],C.prototype,'minimalHeight',null),z([a.computed],C.prototype,'minimalWidth',null);const D=(Q,R)=>{const S=`[${w}="${Q.id}"]::before {
        content: '';
        width: ${R.naturalWidth}px;
        height: ${R.naturalHeight}px;
        background-image: url(${R.src});
        background-size: 100% 100%;
    }`,T=F.insertRule(S,0),U=F.cssRules[T].style;return new A(U,R.naturalWidth,R.naturalHeight)},F=function(){const Q=o();return document.head.appendChild(Q),Q.sheet}(),G={velocityScale:0.8,backgroundImage:y,createBackground:p(D)};var H=function(Q,R,S,T){var W,U=arguments.length,V=3>U?R:null===T?T=Object.getOwnPropertyDescriptor(R,S):T;if('object'==typeof Reflect&&'function'==typeof Reflect.decorate)V=Reflect.decorate(Q,R,S,T);else for(var X=Q.length-1;0<=X;X--)(W=Q[X])&&(V=(3>U?W(V):3<U?W(R,S,V):W(R,S))||V);return 3<U&&V&&Object.defineProperty(R,S,V),V};class I{constructor(Q){const R=()=>{this.update(Q.getBoundingClientRect()),window.requestAnimationFrame(R)};R()}update(Q){for(let R of['bottom','height','left','right','top','width'])this[R]=Q[R]}}H([a.observable],I.prototype,'bottom',void 0),H([a.observable],I.prototype,'height',void 0),H([a.observable],I.prototype,'left',void 0),H([a.observable],I.prototype,'right',void 0),H([a.observable],I.prototype,'top',void 0),H([a.observable],I.prototype,'width',void 0),H([a.action],I.prototype,'update',null);var J=function(Q,R,S,T){var W,U=arguments.length,V=3>U?R:null===T?T=Object.getOwnPropertyDescriptor(R,S):T;if('object'==typeof Reflect&&'function'==typeof Reflect.decorate)V=Reflect.decorate(Q,R,S,T);else for(var X=Q.length-1;0<=X;X--)(W=Q[X])&&(V=(3>U?W(V):3<U?W(R,S,V):W(R,S))||V);return 3<U&&V&&Object.defineProperty(R,S,V),V};class K{constructor(Q,R){Object.assign(Q.style,{overflowY:'scroll',transformStyle:'flat',perspective:R+'px',perspectiveOrigin:'0 0'}),this.element=Q,this.perspective=R,this.boundingClientRect=new I(Q)}get height(){return this.boundingClientRect.height}get top(){return this.boundingClientRect.top}}J([a.computed],K.prototype,'height',null),J([a.computed],K.prototype,'top',null);var L=function(Q,R,S,T){var W,U=arguments.length,V=3>U?R:null===T?T=Object.getOwnPropertyDescriptor(R,S):T;if('object'==typeof Reflect&&'function'==typeof Reflect.decorate)V=Reflect.decorate(Q,R,S,T);else for(var X=Q.length-1;0<=X;X--)(W=Q[X])&&(V=(3>U?W(V):3<U?W(R,S,V):W(R,S))||V);return 3<U&&V&&Object.defineProperty(R,S,V),V};class M{constructor(Q,R,S){this.id=M.getNextId(),this.element=Q,this.boundingClientRect=new I(Q),this.viewport=R,this.velocityScale=S,this.element.setAttribute(w,this.id)}get width(){return this.boundingClientRect.width}get height(){return this.boundingClientRect.height}get left(){return this.boundingClientRect.left}get top(){return this.boundingClientRect.top}static getNextId(){return`${M.nextId++}`}}M.nextId=0,L([a.computed],M.prototype,'width',null),L([a.computed],M.prototype,'height',null),L([a.computed],M.prototype,'left',null),L([a.computed],M.prototype,'top',null);var N=function(Q,R,S,T){return new(S||(S=Promise))(function(U,V){function W(Z){try{Y(T.next(Z))}catch($){V($)}}function X(Z){try{Y(T['throw'](Z))}catch($){V($)}}function Y(Z){Z.done?U(Z.value):new S(function($){$(Z.value)}).then(W,X)}Y((T=T.apply(Q,R||[])).next())})};(function(){const Q=n();Q.insertRule(`
        [${w}] > * {
            position: relative;
        }
    `,0),Q.insertRule(`
        [${w}] {
            position: relative;
            overflow: hidden;
        }
    `,0)})();class O{constructor(Q,R=!v(),S=1e3){R&&(S=0),this.useFallback=R,this.viewport=new K(b(Q),S)}add(Q,R={}){const S=q(R);if(0>S.velocityScale)throw new RangeError('velocityScale must be positive');return f(Q,this.viewport.element).filter(T=>!T.hasAttribute(w)).map(T=>this.addElement(T,S))}addElement(Q,R){return N(this,void 0,void 0,function*(){const S=yield j(Q,R.backgroundImage),T=new M(Q,this.viewport,R.velocityScale),U=R.createBackground(T,S),V=this.useFallback?t:s;a.autorun(()=>{U.updateTransform(V(T,U))})})}}O.getCSSBackgroundImage=y,O.pesudoBefore=D,O.insertImg=(Q,R)=>{const S=document.createElement('img');return S.height=R.naturalHeight,S.width=R.naturalWidth,S.src=R.src,Q.element.insertBefore(S,Q.element.firstElementChild),new A(S.style,R.naturalWidth,R.naturalHeight)},O.coverElement=p,window.Parallax=O})(mobx);
