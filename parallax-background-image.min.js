(function(a){"use strict";function b(Q,R,S,T){var W,U=arguments.length,V=3>U?R:null===T?T=Object.getOwnPropertyDescriptor(R,S):T;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)V=Reflect.decorate(Q,R,S,T);else for(var X=Q.length-1;0<=X;X--)(W=Q[X])&&(V=(3>U?W(V):3<U?W(R,S,V):W(R,S))||V);return 3<U&&V&&Object.defineProperty(R,S,V),V}function f(Q,R,S,T){return new(S||(S=Promise))(function(U,V){function W(Z){try{Y(T.next(Z))}catch($){V($)}}function X(Z){try{Y(T.throw(Z))}catch($){V($)}}function Y(Z){Z.done?U(Z.value):new S(function($){$(Z.value)}).then(W,X)}Y((T=T.apply(Q,R||[])).next())})}function g(Q,R=document){return"string"==typeof Q?R.querySelector(Q):Q}function h(Q,R=document){return Q instanceof Element?[Q]:Array.isArray(Q)?Q:("string"==typeof Q&&(Q=R.querySelectorAll(Q)),Array.prototype.slice.call(Q))}function j(Q){return"function"==typeof Q?Q:()=>Q}function k(Q){const R=j(Q);return function(){return f(this,arguments,void 0,function*(){return yield R.apply(this,arguments)})}}function l(Q,R){return k(R)(Q).then(m)}function m(Q){return new Promise((R,S)=>{const T=document.createElement("img");T.onload=U=>{R(U.target)},T.onerror=U=>{S(U.error)},T.src=Q})}function n(Q){return Q.match(/url\(['"]?(.*?)['"]?\)/)[1]}function p(){const Q=q();return document.head.insertBefore(Q,document.head.firstElementChild),Q.sheet}function q(){const Q=document.createElement("style");return Q.appendChild(document.createTextNode("")),Q}function s(Q,R=null){return(S,T)=>{R=R||S;const U=Q(S,T);return new G(U,R)}}function t(Q){return Object.assign({},K,Q)}function u(Q,R){const S=1/Q.velocityScale,T=Q.viewport;return{scale:S,translateX:Q.left*(S-1),translateY:((T.height-R.height)*S-(T.height-Q.height))/2,translateZ:T.perspective*(1-S)}}function v(Q,R){const S=Q.viewport,T=S.top+S.height/2,U=Q.top+Q.height/2,V=Q.top+R.height/2;return{scale:1,translateX:0,translateY:(U-T)*(Q.velocityScale-1)-(V-U),translateZ:0}}function x(){const{userAgent:Q}=navigator;return Q.includes("Chrome/")&&!Q.includes("Edge/")}function y(Q){Q.style.setProperty("background","none","important"),Q.style.setProperty("background-image","none","important")}const z="data-parallax-element",A=Q=>{const R=window.getComputedStyle(Q);return n(R.backgroundImage)};class B{constructor(){this.tasks=[]}get done(){return 0===this.tasks.length}schedule(Q){this.tasks.push(Q)}run(){const Q=this.tasks.length;for(let R=0;R<Q;++R)this.tasks.shift()()}}const D=new class{constructor(){this.readRunner=new B,this.writeRunner=new B,this.running=!1}read(Q){this.readRunner.schedule(Q),this.running||this.run()}write(Q){this.writeRunner.schedule(Q),this.running||this.run()}run(){this.running=!0,window.requestAnimationFrame(()=>{this.readRunner.run(),this.writeRunner.run(),this.readRunner.done&&this.writeRunner.done?this.running=!1:this.run()})}};class E{constructor(Q,R,S){this.style=Q,this.width=R,this.height=S,D.write(()=>{Object.assign(Q,{position:"absolute",left:"0",top:"0",transformOrigin:"0 0 0",pointerEvents:"none"})})}updateTransform(Q){const R=`
            translateX(${Q.translateX}px)
            translateY(${Q.translateY}px)
            translateZ(${Q.translateZ}px)
            scale(${Q.scale}, ${Q.scale})`;D.write(()=>{this.style.transform=R})}}class F{constructor(Q){this.background=Q}updateTransform(Q){this.background.updateTransform(Object.assign({},Q,{scale:Q.scale*this.scale}))}get height(){return this.background.height*this.scale}get width(){return this.background.width*this.scale}}b([a.computed],F.prototype,"height",null),b([a.computed],F.prototype,"width",null);class G extends F{constructor(Q,R){super(Q),this.element=R}get scale(){return Math.max(this.minimalHeight/this.background.height,this.minimalWidth/this.background.width)}get minimalHeight(){const{height:Q}=this.element.viewport,{height:R,velocityScale:S}=this.element,T=1<S?R+(S-1)*(Q+R):R+(1-S)*(Q-R);return Math.max(T,Q+S*(Q-R))}get minimalWidth(){return this.element.width}}b([a.computed],G.prototype,"scale",null),b([a.computed],G.prototype,"minimalHeight",null),b([a.computed],G.prototype,"minimalWidth",null);const I=(Q,R)=>{const S=document.createElement("img");return D.write(()=>{S.height=R.naturalHeight,S.width=R.naturalWidth,S.src=R.src,Q.element.insertBefore(S,Q.element.firstElementChild)}),new E(S.style,R.naturalWidth,R.naturalHeight)},J=function(){const Q=q();return document.head.appendChild(Q),Q.sheet}(),K={velocityScale:0.8,backgroundImage:A,createBackground:s(I)};class L{constructor(Q){const R=()=>{this.update(Q.getBoundingClientRect()),D.read(R)};R()}update(Q){this.bottom=Q.bottom,this.height=Q.height,this.left=Q.left,this.right=Q.right,this.top=Q.top,this.width=Q.width}}b([a.observable],L.prototype,"bottom",void 0),b([a.observable],L.prototype,"height",void 0),b([a.observable],L.prototype,"left",void 0),b([a.observable],L.prototype,"right",void 0),b([a.observable],L.prototype,"top",void 0),b([a.observable],L.prototype,"width",void 0),b([a.action],L.prototype,"update",null);class M{constructor(Q,R){Object.assign(Q.style,{overflowY:"scroll",webkitOverflowScrolling:"touch",transformStyle:"flat",perspective:R+"px",perspectiveOrigin:"0 0"}),this.element=Q,this.perspective=R,this.boundingClientRect=new L(Q)}get height(){return this.boundingClientRect.height}get top(){return this.boundingClientRect.top}}b([a.computed],M.prototype,"height",null),b([a.computed],M.prototype,"top",null);class N{constructor(Q,R,S){this.id=N.getNextId(),this.element=Q,this.boundingClientRect=new L(Q),this.viewport=R,this.velocityScale=S,D.write(()=>{this.element.setAttribute(z,this.id)})}get width(){return this.boundingClientRect.width}get height(){return this.boundingClientRect.height}get left(){return this.boundingClientRect.left}get top(){return this.boundingClientRect.top}static getNextId(){return`${N.nextId++}`}}N.nextId=0,b([a.computed],N.prototype,"width",null),b([a.computed],N.prototype,"height",null),b([a.computed],N.prototype,"left",null),b([a.computed],N.prototype,"top",null),function(){const Q=p();Q.insertRule(`
        [${z}] > * {
            position: relative;
        }
    `,0),Q.insertRule(`
        [${z}] {
            position: relative;
            overflow: hidden;
        }
    `,0)}();class O{constructor(Q,R=!x(),S=1e3){R&&(S=0),this.useFallback=R,this.viewport=new M(g(Q),S)}add(Q,R={}){const S=t(R);if(0>S.velocityScale)throw new RangeError("velocityScale must be positive");return h(Q,this.viewport.element).filter(T=>!T.hasAttribute(z)).map(T=>this.addElement(T,S))}addElement(Q,R){return f(this,void 0,void 0,function*(){const S=yield l(Q,R.backgroundImage),T=new N(Q,this.viewport,R.velocityScale);y(Q);const U=R.createBackground(T,S),V=this.useFallback?v:u;a.autorun(()=>{const W=V(T,U);U.updateTransform(W)})})}}O.scheduler=D,O.getCSSBackgroundImage=A,O.pesudoBefore=(Q,R)=>{const S=`[${z}="${Q.id}"]::before {
        content: '';
        width: ${R.naturalWidth}px;
        height: ${R.naturalHeight}px;
        background-image: url(${R.src});
        background-size: 100% 100%;
    }`,T=J.insertRule(S,0),U=J.cssRules[T].style;return new E(U,R.naturalWidth,R.naturalHeight)},O.insertImg=I,O.coverElement=s,window.Parallax=O})(mobx);
